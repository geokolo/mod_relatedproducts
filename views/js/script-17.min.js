/**
 * Copyright since 2007 PrestaShop SA and Contributors
 * PrestaShop is an International Registered Trademark & Property of PrestaShop SA
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License 3.0 (AFL-3.0)
 * that is bundled with this package in the file LICENSE.md.
 * It is also available through the world-wide-web at this URL:
 * https://opensource.org/licenses/AFL-3.0
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@prestashop.com so we can send you a copy immediately.
 *
* @author    GeoKolo
* @copyright GeoKolo
* @license   https://opensource.org/licenses/AFL-3.0 Academic Free License 3.0 (AFL-3.0)
*/

!function (t) { t.fn.skRelatedProduct = function () { var e = t(this), n = e.attr("ajax-link") || null, i = e.attr("ajax-remote_url") || null, a = e.attr("id-product") || 0, d = "undefined" != typeof update_success_msg ? update_success_msg : "Updated successfully!"; e.find(".related_product tbody").sortable({ stop: function (i, r) { var o = new Array; e.find('input[name="related_product_input[]"]').each(function (e) { o.push(t(this).val()) }), o.length && t.post(n, { id_product: a, related_ids: o, action: "UpdatePositions" }, function (t) { "Ok" === t && showSuccessMessage(d) }) } }), e.find(".related_product tbody").disableSelection(); var r = e.find("#row_template"); e.find("#row_template").remove(); var o = function (e, i) { var o = r.clone().removeAttr("id"); o.find("td").eq(1).text(e), o.find("td").eq(2).text(i), o.find('input[name="related_product_input[]"]').val(e), o.appendTo(".related_product tbody"), t.post(n, { id_product: a, id_related: e, action: "AddProduct" }, function (t) { "Ok" === t && showSuccessMessage(d) }) }; e.find("#product_autocomplete_input").keyup(function () { var n = t.trim(t(this).val()), d = new Array; d.push(a), e.find('input[name="related_product_input[]"]').each(function (e) { d.push(t(this).val()) }), n.length ? t.post(i, { q: n, limit: 20, excludeIds: d.join() }, function (n) { e.find(".ajax_result").html("").hide(); for (var i = 0; i < n.length; i++) { var a = t("<a>").attr("rel", n[i].id).attr("title", n[i].name).attr("href", "javascript:void(0);"); a.html('<img src="' + n[i].image + '" width="36px" height="36px"> <span>' + n[i].id + ". " + n[i].name + "</span></a>"), a.appendTo(t(".ajax_result").show()), a.click(function (e) { e.preventDefault(), o(t(this).attr("rel"), t(this).attr("title")) }) } }, "json") : e.find(".ajax_result").html("").hide() }), e.find("#product_autocomplete_input").blur(function () { t(this).parents().find("#product_autocomplete_input").val(""), setTimeout(function () { e.find(".ajax_result").hide() }, 200) }), e.on("click", ".delete_product_related", function (e) { if (e.preventDefault(), e.stopPropagation(), confirm(confirm_delete_related)) { var i = t(this).closest("tr").find('input[name="related_product_input[]"]').val(); t(this).closest("tr").remove(), t.post(n, { id_product: a, id_related: i, action: "DeleteProduct" }, function (t) { "Ok" === t && showSuccessMessage(d) }) } }) }, t(document).ready(function () { t("#product_related").skRelatedProduct() }) }(jQuery);
